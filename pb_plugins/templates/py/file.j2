# -*- coding: utf-8 -*-
from .._base import Base
from ..generated import {{ plugin_name.lower() }}_pb2, {{ plugin_name.lower() }}_pb2_grpc


{%- for struct in structs %}


{{ struct }}
{%- endfor %}


class {{ plugin_name }}(Base):
    """ Generated by dcsdkgen - Dronecore {{ plugin_name }} API """

    # Plugin name
    name = "{{ plugin_name }}"

    def __init__(self, *args, **kwargs):
        super().__init__(*args, **kwargs)
        {%- for method in methods %}
        {%- if method.is_observable %}
        self._create_{{ method.name.lower() }}_observable
        {%- endif %}
        {%- endfor %}

    def _setub_stub(self, channel):
        """ Setups the api stub """
        self._stub = {{ plugin_name }}

    def _response_success(self, response):
        """ Checks if the request was successfull """
        return (response.action_result.result ==
                {{ plugin_name.lower() }}_pb2.ActionResult.SUCCESS)

    {%- for method in methods %}
    {{ indent(method, 1) }}

    {%- endfor %}
